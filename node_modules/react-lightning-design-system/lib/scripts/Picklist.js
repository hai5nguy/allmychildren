'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.PicklistItem = undefined;

var _extends2 = require('babel-runtime/helpers/extends');

var _extends3 = _interopRequireDefault(_extends2);

var _objectWithoutProperties2 = require('babel-runtime/helpers/objectWithoutProperties');

var _objectWithoutProperties3 = _interopRequireDefault(_objectWithoutProperties2);

var _getPrototypeOf = require('babel-runtime/core-js/object/get-prototype-of');

var _getPrototypeOf2 = _interopRequireDefault(_getPrototypeOf);

var _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

var _createClass2 = require('babel-runtime/helpers/createClass');

var _createClass3 = _interopRequireDefault(_createClass2);

var _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');

var _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);

var _inherits2 = require('babel-runtime/helpers/inherits');

var _inherits3 = _interopRequireDefault(_inherits2);

var _react = require('react');

var _react2 = _interopRequireDefault(_react);

var _reactDom = require('react-dom');

var _reactDom2 = _interopRequireDefault(_reactDom);

var _classnames = require('classnames');

var _classnames2 = _interopRequireDefault(_classnames);

var _FormElement = require('./FormElement');

var _FormElement2 = _interopRequireDefault(_FormElement);

var _Icon = require('./Icon');

var _Icon2 = _interopRequireDefault(_Icon);

var _DropdownMenu = require('./DropdownMenu');

var _DropdownMenu2 = _interopRequireDefault(_DropdownMenu);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var Picklist = function (_React$Component) {
  (0, _inherits3.default)(Picklist, _React$Component);

  function Picklist(props) {
    (0, _classCallCheck3.default)(this, Picklist);

    var _this = (0, _possibleConstructorReturn3.default)(this, (0, _getPrototypeOf2.default)(Picklist).call(this, props));

    _this.state = { opened: props.defaultOpened, value: props.defaultValue };
    return _this;
  }

  (0, _createClass3.default)(Picklist, [{
    key: 'componentDidUpdate',
    value: function componentDidUpdate(prevProps, prevState) {
      if (this.props.onValueChange && prevState.value !== this.state.value) {
        this.props.onValueChange(this.state.value, prevState.value);
      }
    }
  }, {
    key: 'onClick',
    value: function onClick() {
      var _this2 = this;

      this.setState({ opened: !this.state.opened });
      setTimeout(function () {
        _this2.focusToTargetItemEl();
      }, 10);
    }
  }, {
    key: 'onPicklistItemClick',
    value: function onPicklistItemClick(item, e) {
      var _this3 = this;

      this.setState({ value: item.value });
      if (this.props.onChange) {
        this.props.onChange(e, item.value);
      }
      if (this.props.onSelect) {
        this.props.onSelect(item);
      }
      setTimeout(function () {
        _this3.setState({ opened: false });
        if (_this3.props.onComplete) {
          _this3.props.onComplete();
        }
        var picklistButtonEl = _reactDom2.default.findDOMNode(_this3.refs.picklistButton);
        if (picklistButtonEl) {
          picklistButtonEl.focus();
        }
      }, 200);
      e.preventDefault();
      e.stopPropagation();
    }
  }, {
    key: 'onPicklistClose',
    value: function onPicklistClose() {
      var picklistButtonEl = _reactDom2.default.findDOMNode(this.refs.picklistButton);
      picklistButtonEl.focus();
      this.setState({ opened: false });
    }
  }, {
    key: 'onBlur',
    value: function onBlur() {
      var _this4 = this;

      setTimeout(function () {
        if (!_this4.isFocusedInComponent()) {
          _this4.setState({ opened: false });
          if (_this4.props.onBlur) {
            _this4.props.onBlur();
          }
          if (_this4.props.onComplete) {
            _this4.props.onComplete();
          }
        }
      }, 10);
    }
  }, {
    key: 'onKeydown',
    value: function onKeydown(e) {
      var _this5 = this;

      if (e.keyCode === 40) {
        // down
        e.preventDefault();
        e.stopPropagation();
        if (!this.state.opened) {
          this.setState({ opened: true });
          setTimeout(function () {
            _this5.focusToTargetItemEl();
          }, 10);
        } else {
          this.focusToTargetItemEl();
        }
      } else if (e.keyCode === 27) {
        // ESC
        e.preventDefault();
        e.stopPropagation();
        this.setState({ opened: false });
        if (this.props.onComplete) {
          this.props.onComplete();
        }
      }
      if (this.props.onKeyDown) {
        this.props.onKeyDown(e);
      }
    }
  }, {
    key: 'getSelectedValue',
    value: function getSelectedValue() {
      var _props = this.props;
      var defaultValue = _props.defaultValue;
      var value = _props.value;

      return typeof value !== 'undefined' ? value : typeof this.state.value !== 'undefined' ? this.state.value : defaultValue;
    }
  }, {
    key: 'getSelectedItemLabel',
    value: function getSelectedItemLabel() {
      var selectedValue = this.getSelectedValue();
      var selected = null;
      _react2.default.Children.forEach(this.props.children, function (item) {
        if (item.props.value === selectedValue) {
          selected = item.props.label || item.props.children;
        }
      });
      return selected || this.props.selectedText;
    }
  }, {
    key: 'isFocusedInComponent',
    value: function isFocusedInComponent() {
      var rootEl = _reactDom2.default.findDOMNode(this);
      var targetEl = document.activeElement;
      while (targetEl && targetEl !== rootEl) {
        targetEl = targetEl.parentNode;
      }
      return !!targetEl;
    }
  }, {
    key: 'focusToTargetItemEl',
    value: function focusToTargetItemEl() {
      var dropdownEl = _reactDom2.default.findDOMNode(this.refs.dropdown);
      var firstItemEl = dropdownEl.querySelector('.slds-is-selected > .react-slds-menuitem[tabIndex]') || dropdownEl.querySelector('.react-slds-menuitem[tabIndex]');
      if (firstItemEl) {
        firstItemEl.focus();
      }
    }
  }, {
    key: 'renderPicklist',
    value: function renderPicklist(props) {
      var className = props.className;
      var id = props.id;
      var menuSize = props.menuSize;
      var children = props.children;
      var pprops = (0, _objectWithoutProperties3.default)(props, ['className', 'id', 'menuSize', 'children']);

      var picklistClassNames = (0, _classnames2.default)(className, 'slds-picklist');
      return _react2.default.createElement(
        'div',
        { className: picklistClassNames, 'aria-expanded': this.state.opened },
        _react2.default.createElement(
          'button',
          (0, _extends3.default)({ id: id, ref: 'picklistButton', className: 'slds-picklist__label slds-button slds-button--neutral',
            type: 'button', 'aria-haspopup': true }, pprops, {
            onClick: this.onClick.bind(this),
            onBlur: this.onBlur.bind(this),
            onKeyDown: this.onKeydown.bind(this)
          }),
          _react2.default.createElement(
            'span',
            { className: 'slds-truncate' },
            this.getSelectedItemLabel() || _react2.default.createElement(
              'span',
              null,
              'Â '
            )
          ),
          _react2.default.createElement(_Icon2.default, { icon: 'down' })
        )
      );
    }
  }, {
    key: 'renderDropdown',
    value: function renderDropdown() {
      var _props2 = this.props;
      var menuSize = _props2.menuSize;
      var children = _props2.children;

      return this.state.opened ? _react2.default.createElement(
        _DropdownMenu2.default,
        { ref: 'dropdown', size: menuSize,
          onMenuItemClick: this.onPicklistItemClick.bind(this),
          onMenuClose: this.onPicklistClose.bind(this)
        },
        _react2.default.Children.map(children, this.renderPicklistItem.bind(this))
      ) : _react2.default.createElement('div', { ref: 'dropdown' });
    }
  }, {
    key: 'renderPicklistItem',
    value: function renderPicklistItem(item) {
      var selected = item.props.value === this.getSelectedValue();
      var onBlur = this.onBlur.bind(this);
      return _react2.default.cloneElement(item, { selected: selected, onBlur: onBlur });
    }
  }, {
    key: 'render',
    value: function render() {
      var _props3 = this.props;
      var label = _props3.label;
      var required = _props3.required;
      var error = _props3.error;
      var totalCols = _props3.totalCols;
      var cols = _props3.cols;
      var props = (0, _objectWithoutProperties3.default)(_props3, ['label', 'required', 'error', 'totalCols', 'cols']);

      var dropdown = this.renderDropdown();
      var formElemProps = { id: props.id, label: label, required: required, error: error, totalCols: totalCols, cols: cols, dropdown: dropdown };
      return _react2.default.createElement(
        _FormElement2.default,
        formElemProps,
        this.renderPicklist(props)
      );
    }
  }]);
  return Picklist;
}(_react2.default.Component);

exports.default = Picklist;


Picklist.propTypes = {
  className: _react.PropTypes.string,
  label: _react.PropTypes.string,
  required: _react.PropTypes.bool,
  error: _react.PropTypes.oneOfType([_react.PropTypes.bool, _react.PropTypes.string, _react.PropTypes.shape({
    message: _react.PropTypes.string
  })]),
  name: _react.PropTypes.string,
  value: _react.PropTypes.any,
  defaultValue: _react.PropTypes.any,
  selectedText: _react.PropTypes.string,
  defaultOpened: _react.PropTypes.bool,
  onChange: _react.PropTypes.func,
  onValueChange: _react.PropTypes.func,
  onSelect: _react.PropTypes.func,
  onComplete: _react.PropTypes.func,
  onKeyDown: _react.PropTypes.func,
  onBlur: _react.PropTypes.func,
  totalCols: _react.PropTypes.number,
  cols: _react.PropTypes.number,
  // TODO: Such props should be taken from component
  menuSize: _react.PropTypes.string,
  children: _react.PropTypes.node
};

Picklist.isFormElement = true;

var PicklistItem = exports.PicklistItem = function (_React$Component2) {
  (0, _inherits3.default)(PicklistItem, _React$Component2);

  function PicklistItem() {
    (0, _classCallCheck3.default)(this, PicklistItem);
    return (0, _possibleConstructorReturn3.default)(this, (0, _getPrototypeOf2.default)(PicklistItem).apply(this, arguments));
  }

  (0, _createClass3.default)(PicklistItem, [{
    key: 'render',
    value: function render() {
      var _props4 = this.props;
      var label = _props4.label;
      var selected = _props4.selected;
      var value = _props4.value;
      var children = _props4.children;
      var props = (0, _objectWithoutProperties3.default)(_props4, ['label', 'selected', 'value', 'children']);

      return _react2.default.createElement(
        _DropdownMenu.DropdownMenuItem,
        (0, _extends3.default)({ icon: selected ? 'check' : 'none', role: 'menuitemradio', selected: selected }, props),
        label || children
      );
    }
  }]);
  return PicklistItem;
}(_react2.default.Component);

PicklistItem.propTypes = {
  label: _react.PropTypes.oneOfType([_react.PropTypes.string, _react.PropTypes.number]),
  selected: _react.PropTypes.bool,
  value: _react.PropTypes.any,
  children: _react.PropTypes.node
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9zY3JpcHRzL1BpY2tsaXN0LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7SUFRcUI7OztBQUNuQixXQURtQixRQUNuQixDQUFZLEtBQVosRUFBbUI7d0NBREEsVUFDQTs7NkZBREEscUJBRVgsUUFEVzs7QUFFakIsVUFBSyxLQUFMLEdBQWEsRUFBRSxRQUFRLE1BQU0sYUFBTixFQUFxQixPQUFPLE1BQU0sWUFBTixFQUFuRCxDQUZpQjs7R0FBbkI7OzZCQURtQjs7dUNBTUEsV0FBVyxXQUFXO0FBQ3ZDLFVBQUksS0FBSyxLQUFMLENBQVcsYUFBWCxJQUE0QixVQUFVLEtBQVYsS0FBb0IsS0FBSyxLQUFMLENBQVcsS0FBWCxFQUFrQjtBQUNwRSxhQUFLLEtBQUwsQ0FBVyxhQUFYLENBQXlCLEtBQUssS0FBTCxDQUFXLEtBQVgsRUFBa0IsVUFBVSxLQUFWLENBQTNDLENBRG9FO09BQXRFOzs7OzhCQUtROzs7QUFDUixXQUFLLFFBQUwsQ0FBYyxFQUFFLFFBQVEsQ0FBQyxLQUFLLEtBQUwsQ0FBVyxNQUFYLEVBQXpCLEVBRFE7QUFFUixpQkFBVyxZQUFNO0FBQ2YsZUFBSyxtQkFBTCxHQURlO09BQU4sRUFFUixFQUZILEVBRlE7Ozs7d0NBT1UsTUFBTSxHQUFHOzs7QUFDM0IsV0FBSyxRQUFMLENBQWMsRUFBRSxPQUFPLEtBQUssS0FBTCxFQUF2QixFQUQyQjtBQUUzQixVQUFJLEtBQUssS0FBTCxDQUFXLFFBQVgsRUFBcUI7QUFDdkIsYUFBSyxLQUFMLENBQVcsUUFBWCxDQUFvQixDQUFwQixFQUF1QixLQUFLLEtBQUwsQ0FBdkIsQ0FEdUI7T0FBekI7QUFHQSxVQUFJLEtBQUssS0FBTCxDQUFXLFFBQVgsRUFBcUI7QUFDdkIsYUFBSyxLQUFMLENBQVcsUUFBWCxDQUFvQixJQUFwQixFQUR1QjtPQUF6QjtBQUdBLGlCQUFXLFlB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LFFBQVgsSUFBMkIsTUFBdkc7UUFDSSxTQUFTLFFBQVQ7T0FGTixDQUZPOzs7U0FGRTtFQUFxQixnQkFBTSxTQUFOOztBQWFsQyxhQUFhLFNBQWIsR0FBeUI7QUFDdkIsU0FBTyxpQkFBVSxTQUFWLENBQW9CLENBQ3pCLGlCQUFVLE1BQVYsRUFDQSxpQkFBVSxNQUFWLENBRkssQ0FBUDtBQUlBLFlBQVUsaUJBQVUsSUFBVjtBQUNWLFNBQU8saUJBQVUsR0FBVjtBQUNQLFlBQVUsaUJBQVUsSUFBVjtDQVBaIiwiZmlsZSI6IlBpY2tsaXN0LmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7IFByb3BUeXBlcyB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBSZWFjdERPTSBmcm9tICdyZWFjdC1kb20nO1xuaW1wb3J0IGNsYXNzbmFtZXMgZnJvbSAnY2xhc3NuYW1lcyc7XG5pbXBvcnQgRm9ybUVsZW1lbnQgZnJvbSAnLi9Gb3JtRWxlbWVudCc7XG5pbXBvcnQgSWNvbiBmcm9tICcuL0ljb24nO1xuaW1wb3J0IHsgZGVmYXVsdCBhcyBEcm9wZG93bk1lbnUsIERyb3Bkb3duTWVudUl0ZW0gfSBmcm9tICcuL0Ryb3Bkb3duTWVudSc7XG5cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUGlja2xpc3QgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICBjb25zdHJ1Y3Rvcihwcm9wcykge1xuICAgIHN1cGVyKHByb3BzKTtcbiAgICB0aGlzLnN0YXRlID0geyBvcGVuZWQ6IHByb3BzLmRlZmF1bHRPcGVuZWQsIHZhbHVlOiBwcm9wcy5kZWZhdWx0VmFsdWUgfTtcbiAgfVxuXG4gIGNvbXBvbmVudERpZFVwZGF0ZShwcmV2UHJvcHMsIHByZXZTdGF0ZSkge1xuICAgIGlmICh0aGlzLnByb3BzLm9uVmFsdWVDaGFuZ2UgJiYgcHJldlN0YXRlLnZhbHVlICE9PSB0aGlzLnN0YXRlLnZhbHVlKSB7XG4gICAgICB0aGlzLnByb3BzLm9uVmFsdWVDaGFuZ2UodGhpcy5zdGF0ZS52YWx1ZSwgcHJldlN0YXRlLnZhbHVlKTtcbiAgICB9XG4gIH1cblxuICBvbkNsaWNrKCkge1xuICAgIHRoaXMuc2V0U3RhdGUoeyBvcGVuZWQ6ICF0aGlzLnN0YXRlLm9wZW5lZCB9KTtcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIHRoaXMuZm9jdXNUb1RhcmdldEl0ZW1FbCgpO1xuICAgIH0sIDEwKTtcbiAgfVxuXG4gIG9uUGlja2xpc3RJdGVtQ2xpY2soaXRlbSwgZSkge1xuICAgIHRoaXMuc2V0U3RhdGUoeyB2YWx1ZTogaXRlbS52YWx1ZSB9KTtcbiAgICBpZiAodGhpcy5wcm9wcy5vbkNoYW5nZSkge1xuICAgICAgdGhpcy5wcm9wcy5vbkNoYW5nZShlLCBpdGVtLnZhbHVlKTtcbiAgICB9XG4gICAgaWYgKHRoaXMucHJvcHMub25TZWxlY3QpIHtcbiAgICAgIHRoaXMucHJvcHMub25TZWxlY3QoaXRlbSk7XG4gICAgfVxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgdGhpcy5zZXRTdGF0ZSh7IG9wZW5lZDogZmFsc2UgfSk7XG4gICAgICBpZiAodGhpcy5wcm9wcy5vbkNvbXBsZXRlKSB7XG4gICAgICAgIHRoaXMucHJvcHMub25Db21wbGV0ZSgpO1xuICAgICAgfVxuICAgICAgY29uc3QgcGlja2xpc3RCdXR0b25FbCA9IFJlYWN0RE9NLmZpbmRET01Ob2RlKHRoaXMucmVmcy5waWNrbGlzdEJ1dHRvbik7XG4gICAgICBpZiAocGlja2xpc3RCdXR0b25FbCkge1xuICAgICAgICBwaWNrbGlzdEJ1dHRvbkVsLmZvY3VzKCk7XG4gICAgICB9XG4gICAgfSwgMjAwKTtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgfVxuXG4gIG9uUGlja2xpc3RDbG9zZSgpIHtcbiAgICBjb25zdCBwaWNrbGlzdEJ1dHRvbkVsID0gUmVhY3RET00uZmluZERPTU5vZGUodGhpcy5yZWZzLnBpY2tsaXN0QnV0dG9uKTtcbiAgICBwaWNrbGlzdEJ1dHRvbkVsLmZvY3VzKCk7XG4gICAgdGhpcy5zZXRTdGF0ZSh7IG9wZW5lZDogZmFsc2UgfSk7XG4gIH1cblxuICBvbkJsdXIoKSB7XG4gICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICBpZiAoIXRoaXMuaXNGb2N1c2VkSW5Db21wb25lbnQoKSkge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHsgb3BlbmVkOiBmYWxzZSB9KTtcbiAgICAgICAgaWYgKHRoaXMucHJvcHMub25CbHVyKSB7XG4gICAgICAgICAgdGhpcy5wcm9wcy5vbkJsdXIoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5wcm9wcy5vbkNvbXBsZXRlKSB7XG4gICAgICAgICAgdGhpcy5wcm9wcy5vbkNvbXBsZXRlKCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LCAxMCk7XG4gIH1cblxuICBvbktleWRvd24oZSkge1xuICAgIGlmIChlLmtleUNvZGUgPT09IDQwKSB7IC8vIGRvd25cbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICBpZiAoIXRoaXMuc3RhdGUub3BlbmVkKSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBvcGVuZWQ6IHRydWUgfSk7XG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIHRoaXMuZm9jdXNUb1RhcmdldEl0ZW1FbCgpO1xuICAgICAgICB9LCAxMCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmZvY3VzVG9UYXJnZXRJdGVtRWwoKTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGUua2V5Q29kZSA9PT0gMjcpIHsgLy8gRVNDXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgdGhpcy5zZXRTdGF0ZSh7IG9wZW5lZDogZmFsc2UgfSk7XG4gICAgICBpZiAodGhpcy5wcm9wcy5vbkNvbXBsZXRlKSB7XG4gICAgICAgIHRoaXMucHJvcHMub25Db21wbGV0ZSgpO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAodGhpcy5wcm9wcy5vbktleURvd24pIHtcbiAgICAgIHRoaXMucHJvcHMub25LZXlEb3duKGUpO1xuICAgIH1cbiAgfVxuXG4gIGdldFNlbGVjdGVkVmFsdWUoKSB7XG4gICAgY29uc3QgeyBkZWZhdWx0VmFsdWUsIHZhbHVlIH0gPSB0aGlzLnByb3BzO1xuICAgIHJldHVybiAoXG4gICAgICB0eXBlb2YgdmFsdWUgIT09ICd1bmRlZmluZWQnID8gdmFsdWUgOlxuICAgICAgdHlwZW9mIHRoaXMuc3RhdGUudmFsdWUgIT09ICd1bmRlZmluZWQnID8gdGhpcy5zdGF0ZS52YWx1ZSA6XG4gICAgICBkZWZhdWx0VmFsdWVcbiAgICApO1xuICB9XG5cbiAgZ2V0U2VsZWN0ZWRJdGVtTGFiZWwoKSB7XG4gICAgY29uc3Qgc2VsZWN0ZWRWYWx1ZSA9IHRoaXMuZ2V0U2VsZWN0ZWRWYWx1ZSgpO1xuICAgIGxldCBzZWxlY3RlZCA9IG51bGw7XG4gICAgUmVhY3QuQ2hpbGRyZW4uZm9yRWFjaCh0aGlzLnByb3BzLmNoaWxkcmVuLCAoaXRlbSkgPT4ge1xuICAgICAgaWYgKGl0ZW0ucHJvcHMudmFsdWUgPT09IHNlbGVjdGVkVmFsdWUpIHtcbiAgICAgICAgc2VsZWN0ZWQgPSBpdGVtLnByb3BzLmxhYmVsIHx8IGl0ZW0ucHJvcHMuY2hpbGRyZW47XG4gICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIChzZWxlY3RlZCB8fCB0aGlzLnByb3BzLnNlbGVjdGVkVGV4dCk7XG4gIH1cblxuICBpc0ZvY3VzZWRJbkNvbXBvbmVudCgpIHtcbiAgICBjb25zdCByb290RWwgPSBSZWFjdERPTS5maW5kRE9NTm9kZSh0aGlzKTtcbiAgICBsZXQgdGFyZ2V0RWwgPSBkb2N1bWVudC5hY3RpdmVFbGVtZW50O1xuICAgIHdoaWxlICh0YXJnZXRFbCAmJiB0YXJnZXRFbCAhPT0gcm9vdEVsKSB7XG4gICAgICB0YXJnZXRFbCA9IHRhcmdldEVsLnBhcmVudE5vZGU7XG4gICAgfVxuICAgIHJldHVybiAhIXRhcmdldEVsO1xuICB9XG5cbiAgZm9jdXNUb1RhcmdldEl0ZW1FbCgpIHtcbiAgICBjb25zdCBkcm9wZG93bkVsID0gUmVhY3RET00uZmluZERPTU5vZGUodGhpcy5yZWZzLmRyb3Bkb3duKTtcbiAgICBjb25zdCBmaXJzdEl0ZW1FbCA9XG4gICAgICBkcm9wZG93bkVsLnF1ZXJ5U2VsZWN0b3IoJy5zbGRzLWlzLXNlbGVjdGVkID4gLnJlYWN0LXNsZHMtbWVudWl0ZW1bdGFiSW5kZXhdJykgfHxcbiAgICAgIGRyb3Bkb3duRWwucXVlcnlTZWxlY3RvcignLnJlYWN0LXNsZHMtbWVudWl0ZW1bdGFiSW5kZXhdJyk7XG4gICAgaWYgKGZpcnN0SXRlbUVsKSB7XG4gICAgICBmaXJzdEl0ZW1FbC5mb2N1cygpO1xuICAgIH1cbiAgfVxuXG4gIHJlbmRlclBpY2tsaXN0KHByb3BzKSB7XG4gICAgY29uc3QgeyBjbGFzc05hbWUsIGlkLCBtZW51U2l6ZSwgY2hpbGRyZW4sIC4uLnBwcm9wcyB9ID0gcHJvcHM7XG4gICAgY29uc3QgcGlja2xpc3RDbGFzc05hbWVzID0gY2xhc3NuYW1lcyhjbGFzc05hbWUsICdzbGRzLXBpY2tsaXN0Jyk7XG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXYgY2xhc3NOYW1lPXsgcGlja2xpc3RDbGFzc05hbWVzIH0gYXJpYS1leHBhbmRlZD17IHRoaXMuc3RhdGUub3BlbmVkIH0+XG4gICAgICAgIDxidXR0b24gaWQ9eyBpZCB9IHJlZj0ncGlja2xpc3RCdXR0b24nIGNsYXNzTmFtZT0nc2xkcy1waWNrbGlzdF9fbGFiZWwgc2xkcy1idXR0b24gc2xkcy1idXR0b24tLW5ldXRyYWwnXG4gICAgICAgICAgdHlwZT0nYnV0dG9uJyBhcmlhLWhhc3BvcHVwIHsgLi4ucHByb3BzIH1cbiAgICAgICAgICBvbkNsaWNrPXsgdGhpcy5vbkNsaWNrLmJpbmQodGhpcykgfVxuICAgICAgICAgIG9uQmx1cj17IHRoaXMub25CbHVyLmJpbmQodGhpcykgfVxuICAgICAgICAgIG9uS2V5RG93bj17IHRoaXMub25LZXlkb3duLmJpbmQodGhpcykgfVxuICAgICAgICA+XG4gICAgICAgICAgPHNwYW4gY2xhc3NOYW1lPSdzbGRzLXRydW5jYXRlJz57IHRoaXMuZ2V0U2VsZWN0ZWRJdGVtTGFiZWwoKSB8fCA8c3Bhbj4mbmJzcDs8L3NwYW4+IH08L3NwYW4+XG4gICAgICAgICAgPEljb24gaWNvbj0nZG93bicgLz5cbiAgICAgICAgPC9idXR0b24+XG4gICAgICA8L2Rpdj5cbiAgICApO1xuICB9XG5cbiAgcmVuZGVyRHJvcGRvd24oKSB7XG4gICAgY29uc3QgeyBtZW51U2l6ZSwgY2hpbGRyZW4gfSA9IHRoaXMucHJvcHM7XG4gICAgcmV0dXJuIChcbiAgICAgIHRoaXMuc3RhdGUub3BlbmVkID9cbiAgICAgIDxEcm9wZG93bk1lbnUgcmVmPSdkcm9wZG93bicgc2l6ZT17IG1lbnVTaXplIH1cbiAgICAgICAgb25NZW51SXRlbUNsaWNrPXsgdGhpcy5vblBpY2tsaXN0SXRlbUNsaWNrLmJpbmQodGhpcykgfVxuICAgICAgICBvbk1lbnVDbG9zZT17IHRoaXMub25QaWNrbGlzdENsb3NlLmJpbmQodGhpcykgfVxuICAgICAgPlxuICAgICAgICB7IFJlYWN0LkNoaWxkcmVuLm1hcChjaGlsZHJlbiwgdGhpcy5yZW5kZXJQaWNrbGlzdEl0ZW0uYmluZCh0aGlzKSkgfVxuICAgICAgPC9Ecm9wZG93bk1lbnU+IDpcbiAgICAgIDxkaXYgcmVmPSdkcm9wZG93bicgLz5cbiAgICApO1xuICB9XG5cbiAgcmVuZGVyUGlja2xpc3RJdGVtKGl0ZW0pIHtcbiAgICBjb25zdCBzZWxlY3RlZCA9IGl0ZW0ucHJvcHMudmFsdWUgPT09IHRoaXMuZ2V0U2VsZWN0ZWRWYWx1ZSgpO1xuICAgIGNvbnN0IG9uQmx1ciA9IHRoaXMub25CbHVyLmJpbmQodGhpcyk7XG4gICAgcmV0dXJuIFJlYWN0LmNsb25lRWxlbWVudChpdGVtLCB7IHNlbGVjdGVkLCBvbkJsdXIgfSk7XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgY29uc3QgeyBsYWJlbCwgcmVxdWlyZWQsIGVycm9yLCB0b3RhbENvbHMsIGNvbHMsIC4uLnByb3BzIH0gPSB0aGlzLnByb3BzO1xuICAgIGNvbnN0IGRyb3Bkb3duID0gdGhpcy5yZW5kZXJEcm9wZG93bigpO1xuICAgIGNvbnN0IGZvcm1FbGVtUHJvcHMgPSB7IGlkOiBwcm9wcy5pZCwgbGFiZWwsIHJlcXVpcmVkLCBlcnJvciwgdG90YWxDb2xzLCBjb2xzLCBkcm9wZG93biB9O1xuICAgIHJldHVybiAoXG4gICAgICA8Rm9ybUVsZW1lbnQgeyAuLi5mb3JtRWxlbVByb3BzIH0+XG4gICAgICAgIHsgdGhpcy5yZW5kZXJQaWNrbGlzdChwcm9wcykgfVxuICAgICAgPC9Gb3JtRWxlbWVudD5cbiAgICApO1xuICB9XG5cbn1cblxuUGlja2xpc3QucHJvcFR5cGVzID0ge1xuICBjbGFzc05hbWU6IFByb3BUeXBlcy5zdHJpbmcsXG4gIGxhYmVsOiBQcm9wVHlwZXMuc3RyaW5nLFxuICByZXF1aXJlZDogUHJvcFR5cGVzLmJvb2wsXG4gIGVycm9yOiBQcm9wVHlwZXMub25lT2ZUeXBlKFtcbiAgICBQcm9wVHlwZXMuYm9vbCxcbiAgICBQcm9wVHlwZXMuc3RyaW5nLFxuICAgIFByb3BUeXBlcy5zaGFwZSh7XG4gICAgICBtZXNzYWdlOiBQcm9wVHlwZXMuc3RyaW5nLFxuICAgIH0pLFxuICBdKSxcbiAgbmFtZTogUHJvcFR5cGVzLnN0cmluZyxcbiAgdmFsdWU6IFByb3BUeXBlcy5hbnksXG4gIGRlZmF1bHRWYWx1ZTogUHJvcFR5cGVzLmFueSxcbiAgc2VsZWN0ZWRUZXh0OiBQcm9wVHlwZXMuc3RyaW5nLFxuICBkZWZhdWx0T3BlbmVkOiBQcm9wVHlwZXMuYm9vbCxcbiAgb25DaGFuZ2U6IFByb3BUeXBlcy5mdW5jLFxuICBvblZhbHVlQ2hhbmdlOiBQcm9wVHlwZXMuZnVuYyxcbiAgb25TZWxlY3Q6IFByb3BUeXBlcy5mdW5jLFxuICBvbkNvbXBsZXRlOiBQcm9wVHlwZXMuZnVuYyxcbiAgb25LZXlEb3duOiBQcm9wVHlwZXMuZnVuYyxcbiAgb25CbHVyOiBQcm9wVHlwZXMuZnVuYyxcbiAgdG90YWxDb2xzOiBQcm9wVHlwZXMubnVtYmVyLFxuICBjb2xzOiBQcm9wVHlwZXMubnVtYmVyLFxuICAvLyBUT0RPOiBTdWNoIHByb3BzIHNob3VsZCBiZSB0YWtlbiBmcm9tIGNvbXBvbmVudFxuICBtZW51U2l6ZTogUHJvcFR5cGVzLnN0cmluZyxcbiAgY2hpbGRyZW46IFByb3BUeXBlcy5ub2RlLFxufTtcblxuXG5QaWNrbGlzdC5pc0Zvcm1FbGVtZW50ID0gdHJ1ZTtcblxuXG5leHBvcnQgY2xhc3MgUGlja2xpc3RJdGVtIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50IHtcblxuICByZW5kZXIoKSB7XG4gICAgY29uc3QgeyBsYWJlbCwgc2VsZWN0ZWQsIHZhbHVlLCBjaGlsZHJlbiwgLi4ucHJvcHMgfSA9IHRoaXMucHJvcHM7XG4gICAgcmV0dXJuIChcbiAgICAgIDxEcm9wZG93bk1lbnVJdGVtIGljb249eyBzZWxlY3RlZCA/ICdjaGVjaycgOiAnbm9uZScgfSByb2xlPSdtZW51aXRlbXJhZGlvJyBzZWxlY3RlZD17IHNlbGVjdGVkIH0geyAuLi5wcm9wcyB9PlxuICAgICAgICB7IGxhYmVsIHx8IGNoaWxkcmVuIH1cbiAgICAgIDwvRHJvcGRvd25NZW51SXRlbT5cbiAgICApO1xuICB9XG5cbn1cblxuUGlja2xpc3RJdGVtLnByb3BUeXBlcyA9IHtcbiAgbGFiZWw6IFByb3BUeXBlcy5vbmVPZlR5cGUoW1xuICAgIFByb3BUeXBlcy5zdHJpbmcsXG4gICAgUHJvcFR5cGVzLm51bWJlcixcbiAgXSksXG4gIHNlbGVjdGVkOiBQcm9wVHlwZXMuYm9vbCxcbiAgdmFsdWU6IFByb3BUeXBlcy5hbnksXG4gIGNoaWxkcmVuOiBQcm9wVHlwZXMubm9kZSxcbn07XG4iXX0=